<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Inscription Information</title>
    <link rel="stylesheet" type="text/css" href="./css/index.css">
    <link rel="stylesheet" type="text/css" href="./css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body>
    <header>
      <nav class="Navbar--main">
        <div class="sc-29427738-0 sc-aa344ffa-5 ktOAPP lenEFM">
            <div height="40" width="40" class="sc-29427738-0 dFYEpK">
              <img alt="Orkar.io Logo" src="https://media.discordapp.net/attachments/933585220114972752/1074176618253254676/OrkarLogo.png" width="40" height="40">
            </div>
          </a>
          <div class="sc-29427738-0 sc-630fc9ab-0 hxKAFa jSPhMX">
            <strong>Orkar.io</strong>
          
        </div>
        <form action="#" onsubmit="searchInscription(event); return false;">
          <div class="search-container">
            <input type="text" id="inscriptionId" name="inscriptionid" placeholder="Search Inscription ID">
            <button type="submit">
              <i class="fa fa-search"></i>
            </button>
          </div>
        </form>
        </div>
      </nav>
    </header>

    <h1>Inscription Information</h1>

    <div id="inscriptionInfo"></div>
    <div id="errorMessage" style="display: none;">There was an error fetching the inscription information. Please try again later.</div>

<script>
  const form = document.querySelector("form");

  function searchInscription(event) {
  const inscriptionId = document.getElementById("inscriptionId").value;
  history.pushState({}, '', '?inscriptionid=' + encodeURIComponent(inscriptionId));
  getSite()
}

  function getSite() {
    let urlParams = new URLSearchParams(window.location.search);
    let inscriptionId = urlParams.get('inscriptionid');
    if (inscriptionId) {
      const url = `https://ordapi.xyz/inscription/${inscriptionId}`;
      getData(url)
      console.log(url)
    }
  }

window.addEventListener("load", getSite);

    function getData(url) {
      fetch(url)
        .then(response => response.json())
        .then(inscriptionData => {

          const inscriptionInfoDiv = document.querySelector("#inscriptionInfo");
          const content = inscriptionData["content"];
          const title = inscriptionData["title"];
          const address = inscriptionData["address"];
          const id = inscriptionData["id"];
          const sat = inscriptionData["sat"];
          const contentLength = inscriptionData["content length"];
          const genesisFee = inscriptionData["genesis fee"];
          const genesisHeight = inscriptionData["genesis height"].split("/")[2];
          const genesisTransaction = inscriptionData["genesis transaction"];
          const location = inscriptionData["location"];
          const offset = inscriptionData["offset"];
          const outputValue = inscriptionData["output value"];
          const timestamp = inscriptionData["timestamp"];

          inscriptionInfoDiv.innerHTML = `
          <div id="inscriptionInfo">
          <div style="display: flex;">
          <img src="https://ordinals.com${content}" class="theimg" alt="Inscription Image">

            <div class="topdiv">
              <h2>${title}</h2>
              <p class="address">Owned By: <a href="https://www.blockchain.com/explorer/addresses/btc/${address}" style="color: gray; text-decoration: none; font-weight: bold; font-size: smaller;">
                ${address.substr(0, 5)}-${address.substr(-5)}
              </a></p>
            </div>
          </div>
          <div class="maindiv">
            <p class="inscription-text">ID: <span class="inscription-span">${id}</span></p>
            <hr class="border">
            <p class="inscription-text">Sat: <span class="inscription-span">${sat}</span></p>
            <hr class="border">
            <p class="inscription-text">Content Length: <span class="inscription-span">${contentLength}</span></p>
            <hr class="border">
            <p class="inscription-text">Genesis Fee: <span class="inscription-span">${genesisFee}</span></p>
            <hr class="border">
            <p class="inscription-text">Genesis Height: <a href="https://www.blockchain.com/explorer/blocks/btc/${genesisHeight}" target="_blank" style="color: dimgray; font-weight: bold; text-decoration: none;">${genesisHeight}</a></p>
            <hr class="border">
            <p class="inscription-text">Genesis Transaction: <span class="inscription-span">${genesisTransaction}</span></p>
            <hr class="border">
            <p class="inscription-text">Location: <span class="inscription-span">${inscriptionData["location"]}</span></p>
            <hr class="border">
            <p class="inscription-text">Offset: <span class="inscription-span">${inscriptionData["offset"]}</span></p>
            <hr class="border">
            <p class="inscription-text">Output Value: <span class="inscription-span">${inscriptionData["output value"]}</span></p>
            <hr class="border">
            <p class="inscription-text">Timestamp: <span class="inscription-span">${inscriptionData["timestamp"]}</span></p>
            </div>
      </div> 
    <div>




        `;
      });
    }

</script>
</body>
</html>